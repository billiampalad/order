<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Monitoring Order</title>
    <link rel="icon" type="image/png" href="pt.png" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #f63b3b;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .table-container {
            max-height: 600px;
            overflow-y: auto;
        }
        .table-container::-webkit-scrollbar {
            width: 8px;
        }
        .table-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }
        .table-container::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        .table-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-red-900 via-red-950 to-black min-h-screen">
    <header class="glass-effect p-6 mb-8">
        <div class="max-w-7xl mx-auto">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="bg-blue-500 p-3 rounded-lg">
                        <i class="fas fa-chart-line text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-white">Dashboard Monitoring Order</h1>
                        <p class="text-blue-200">Real-time order tracking and analytics</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="refreshData()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center space-x-2">
                        <i class="fas fa-sync-alt"></i>
                        <span>Refresh</span>
                    </button>
                    <div class="text-white text-sm">
                        <div>Last Updated:</div>
                        <div id="lastUpdated" class="font-semibold">-</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-6">
        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="glass-effect p-6 rounded-xl">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-blue-200 text-sm font-medium">Total Order</p>
                        <p id="totalOrders" class="text-3xl font-bold text-white">-</p>
                    </div>
                    <div class="bg-blue-500 p-3 rounded-lg">
                        <i class="fas fa-shopping-cart text-white"></i>
                    </div>
                </div>
            </div>
            
            <div class="glass-effect p-6 rounded-xl">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-green-200 text-sm font-medium">Jumlah Order Datin</p>
                        <p id="datinOrders" class="text-3xl font-bold text-white">-</p>
                    </div>
                    <div class="bg-green-500 p-3 rounded-lg">
                        <i class="fas fa-network-wired text-white"></i>
                    </div>
                </div>
            </div>
            
            <div class="glass-effect p-6 rounded-xl">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-purple-200 text-sm font-medium">Jumlah Order Wifi</p>
                        <p id="wifiOrders" class="text-3xl font-bold text-white">-</p>
                    </div>
                    <div class="bg-purple-500 p-3 rounded-lg">
                        <i class="fas fa-wifi text-white"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <div class="glass-effect p-6 rounded-xl">
                <h3 class="text-xl font-semibold text-white mb-4">Order Status Distribution</h3>
                <canvas id="statusChart" width="400" height="200"></canvas>
            </div>
            
            <div class="glass-effect p-6 rounded-xl">
                <h3 class="text-xl font-semibold text-white mb-4">Orders by Segment</h3>
                <canvas id="segmentChart" width="400" height="200"></canvas>
            </div>
        </div>

        <!-- Filters -->
        <div class="glass-effect p-6 rounded-xl mb-6">
            <h3 class="text-lg font-semibold text-white mb-4">Filter Options</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm font-medium text-blue-200 mb-2">Tanggal Order From</label>
                    <input type="date" id="dateFromFilter" class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-blue-200 mb-2">Tanggal Order To</label>
                    <input type="date" id="dateToFilter" class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-blue-200 mb-2">Search Order</label>
                    <input type="text" id="searchOrderInput" placeholder="Search order ID, customer..." class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-blue-200 mb-2">Description</label>
                    <input type="text" id="descriptionInput" placeholder="Search description..." class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-blue-200 mb-2">WFM Status</label>
                    <select id="wfmStatusFilter" class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All WFM Status</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-blue-200 mb-2">Owner Group</label>
                    <select id="ownerGroupFilter" class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All Owner Groups</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-blue-200 mb-2">Product Name</label>
                    <select id="productNameFilter" class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All Products</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-blue-200 mb-2">Order Type</label>
                    <select id="orderTypeFilter" class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All Order Types</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-blue-200 mb-2">Segment</label>
                    <select id="segmentFilter" class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All Segments</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-blue-200 mb-2">Ket WO</label>
                    <select id="ketWoFilter" class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All Ket WO</option>
                    </select>
                </div>
            </div>
            <div class="mt-4 flex justify-end">
                <button onclick="clearFilters()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors duration-200 flex items-center space-x-2">
                    <i class="fas fa-times"></i>
                    <span>Clear All Filters</span>
                </button>
            </div>
        </div>

        <!-- Data Table -->
        <div class="glass-effect rounded-xl overflow-hidden mb-8">
            <div class="p-6 border-b border-white/20">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Order Details</h3>
                    <div class="flex items-center space-x-4">
                        <span id="recordCount" class="text-blue-200 text-sm">0 records</span>
                        <button onclick="exportData()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center space-x-2">
                            <i class="fas fa-download"></i>
                            <span>Export</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="loadingContainer" class="flex items-center justify-center p-12">
                <div class="loading-spinner"></div>
                <span class="ml-4 text-white">Loading data...</span>
            </div>
            
            <div id="tableContainer" class="table-container" style="display: none;">
                <table class="w-full">
                    <thead class="bg-white/5 sticky top-0">
                        <tr id="tableHeader">
                            <!-- Headers will be populated dynamically -->
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Data will be populated dynamically -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let allData = [];
        let filteredData = [];
        let statusChart, segmentChart;

        // Column mapping for better display names
        const columnMapping = {
            'LAYANAN': 'Layanan',
            'HSA': 'HSA',
            'NCX_ORDERID': 'NCX Order ID',
            'CUSTOMER_NAME': 'Customer Name',
            'PIC': 'PIC',
            'ADDRESS': 'Address',
            'DESCRIPTION': 'Description',
            'WFM_STATUS': 'WFM Status',
            'OWNERGROUP': 'Owner Group',
            'Tanggal_Pickup_NTE_from_SCMT': 'Tanggal Pickup NTE',
            'LABOR_TEK': 'Labor Tek',
            'PRODUCTNAME': 'Product Name',
            'ORDER_TYPE': 'Order Type',
            'ORDER_DATE': 'Order Date',
            'TTD': 'TTD',
            'UMUR_WO': 'Umur WO',
            'TTI_KONTRAK_BERLANGGANAN': 'TTI Kontrak',
            'SEGMENT': 'Segment',
            'DATEL': 'DATEL',
            'STO': 'STO',
            'SEKTOR': 'Sektor',
            'TEKNISI': 'Teknisi',
            'TGL_PROGRESS': 'Tgl Progress',
            'TEKNISI P2P': 'Teknisi P2P',
            'TANGGAL_P2P': 'Tanggal P2P',
            'KET_WO': 'Ket WO',
            'KETERANGAN': 'Keterangan',
            'TINDAK_LANJUT': 'Tindak Lanjut',
            'TICKET_FO': 'Ticket FO',
            'TOTAL_SCALING': 'Total Scaling',
            'NAMA_AM': 'Nama AM',
            'STATUS_JT': 'Status JT',
            'BANDWIDTH': 'Bandwidth',
            'ODP': 'ODP',
            'GPON': 'GPON',
            'ONT': 'ONT',
            'PANJANG_TARIKAN': 'Panjang Tarikan',
            'KET TAMBAHAN': 'Ket Tambahan',
            'Column1': 'Column1'
        };

        async function fetchData() {
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbxuMVcmdAR_xAsqG0dWq0nshzG9PGR-996DwZM12StBf_mZq9qEx0-eOv99cgEKETOa/exec');
                const data = await response.json();
                
                allData = data;
                filteredData = [...allData];
                
                updateStats();
                updateCharts();
                populateFilters();
                renderTable();
                
                document.getElementById('lastUpdated').textContent = new Date().toLocaleString('id-ID');
                document.getElementById('loadingContainer').style.display = 'none';
                document.getElementById('tableContainer').style.display = 'block';
                
            } catch (error) {
                console.error('Error fetching data:', error);
                document.getElementById('loadingContainer').innerHTML = '<div class="text-red-400"><i class="fas fa-exclamation-triangle mr-2"></i>Error loading data. Please try again.</div>';
            }
        }

        function updateStats() {
            const total = filteredData.length;
            const datinOrders = filteredData.filter(row => row.LAYANAN && row.LAYANAN.toLowerCase().includes('datin')).length;
            const wifiOrders = filteredData.filter(row => row.LAYANAN && row.LAYANAN.toLowerCase().includes('wifi')).length;

            document.getElementById('totalOrders').textContent = total.toLocaleString();
            document.getElementById('datinOrders').textContent = datinOrders.toLocaleString();
            document.getElementById('wifiOrders').textContent = wifiOrders.toLocaleString();
            document.getElementById('recordCount').textContent = `${total.toLocaleString()} records`;
        }

        function updateCharts() {
            // Status Chart based on KET_WO
            const statusCounts = {};
            filteredData.forEach(row => {
                const status = row.KET_WO;
                if (status && status.trim() !== '') {
                    statusCounts[status] = (statusCounts[status] || 0) + 1;
                }
            });

            if (statusChart) statusChart.destroy();
            const statusCtx = document.getElementById('statusChart').getContext('2d');
            statusChart = new Chart(statusCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(statusCounts),
                    datasets: [{
                        data: Object.values(statusCounts),
                        backgroundColor: ['#10b981', '#3b82f6', '#f59e0b', '#ef4444', '#8b5cf6', '#06b6d4', '#f97316', '#84cc16', '#ec4899']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: { color: 'white' }
                        }
                    }
                }
            });

            // Segment Chart
            const segmentCounts = {};
            filteredData.forEach(row => {
                const segment = row.SEGMENT;
                if (segment && segment.trim() !== '') {
                    segmentCounts[segment] = (segmentCounts[segment] || 0) + 1;
                }
            });

            if (segmentChart) segmentChart.destroy();
            const segmentCtx = document.getElementById('segmentChart').getContext('2d');
            segmentChart = new Chart(segmentCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(segmentCounts),
                    datasets: [{
                        data: Object.values(segmentCounts),
                        backgroundColor: '#3b82f6'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            ticks: { color: 'white' },
                            grid: { color: 'rgba(255,255,255,0.1)' }
                        },
                        x: {
                            ticks: { color: 'white' },
                            grid: { color: 'rgba(255,255,255,0.1)' }
                        }
                    }
                }
            });
        }

        function populateFilters() {
            const wfmStatusSet = new Set();
            const ownerGroupSet = new Set();
            const productNameSet = new Set();
            const orderTypeSet = new Set();
            const segmentSet = new Set();
            const ketWoSet = new Set();

            allData.forEach(row => {
                if (row.WFM_STATUS) wfmStatusSet.add(row.WFM_STATUS);
                if (row.OWNERGROUP) ownerGroupSet.add(row.OWNERGROUP);
                if (row.PRODUCTNAME) productNameSet.add(row.PRODUCTNAME);
                if (row.ORDER_TYPE) orderTypeSet.add(row.ORDER_TYPE);
                if (row.SEGMENT) segmentSet.add(row.SEGMENT);
                if (row.KET_WO) ketWoSet.add(row.KET_WO);
            });

            populateSelect('wfmStatusFilter', wfmStatusSet);
            populateSelect('ownerGroupFilter', ownerGroupSet);
            populateSelect('productNameFilter', productNameSet);
            populateSelect('orderTypeFilter', orderTypeSet);
            populateSelect('segmentFilter', segmentSet);
            populateSelect('ketWoFilter', ketWoSet);
        }

        function populateSelect(selectId, options) {
            const select = document.getElementById(selectId);
            const currentValue = select.value;
            
            // Clear existing options except the first one
            while (select.children.length > 1) {
                select.removeChild(select.lastChild);
            }
            
            Array.from(options).sort().forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option;
                select.appendChild(optionElement);
            });
            
            select.value = currentValue;
        }

        function renderTable() {
            if (filteredData.length === 0) return;

            const headers = Object.keys(filteredData[0]);
            const headerRow = document.getElementById('tableHeader');
            
            // Only update headers if they changed
            if (headerRow.children.length === 0) {
                headerRow.innerHTML = headers.map(header => 
                    `<th class="px-4 py-3 text-left text-xs font-medium text-blue-200 uppercase tracking-wider">${columnMapping[header] || header}</th>`
                ).join('');
            }

            const tbody = document.getElementById('tableBody');
            
            // Limit rows for performance - show max 100 rows at once
            const maxRows = 100;
            const displayData = filteredData.slice(0, maxRows);
            
            // Use DocumentFragment for better performance
            const fragment = document.createDocumentFragment();
            
            displayData.forEach((row, index) => {
                const tr = document.createElement('tr');
                tr.className = `${index % 2 === 0 ? 'bg-white/5' : 'bg-white/10'} hover:bg-white/20 transition-colors duration-200`;
                
                headers.forEach(header => {
                    const td = document.createElement('td');
                    td.className = 'px-4 py-3 text-sm text-white whitespace-nowrap';
                    td.textContent = row[header] || '-';
                    tr.appendChild(td);
                });
                
                fragment.appendChild(tr);
            });
            
            tbody.innerHTML = '';
            tbody.appendChild(fragment);
            
            // Show pagination info if data is limited
            if (filteredData.length > maxRows) {
                const recordCount = document.getElementById('recordCount');
                recordCount.textContent = `Showing ${maxRows} of ${filteredData.length.toLocaleString()} records`;
            }
        }

        function applyFilters() {
            // Use setTimeout to allow UI to update before heavy processing
            setTimeout(() => {
                const dateFrom = document.getElementById('dateFromFilter').value;
                const dateTo = document.getElementById('dateToFilter').value;
                const searchOrder = document.getElementById('searchOrderInput').value.toLowerCase();
                const description = document.getElementById('descriptionInput').value.toLowerCase();
                const wfmStatus = document.getElementById('wfmStatusFilter').value;
                const ownerGroup = document.getElementById('ownerGroupFilter').value;
                const productName = document.getElementById('productNameFilter').value;
                const orderType = document.getElementById('orderTypeFilter').value;
                const segment = document.getElementById('segmentFilter').value;
                const ketWo = document.getElementById('ketWoFilter').value;

                filteredData = allData.filter(row => {
                    // Date range filter
                    let matchesDateRange = true;
                    if (dateFrom || dateTo) {
                        const orderDate = row.ORDER_DATE;
                        if (orderDate) {
                            const orderDateObj = new Date(orderDate);
                            if (dateFrom && orderDateObj < new Date(dateFrom)) matchesDateRange = false;
                            if (dateTo && orderDateObj > new Date(dateTo)) matchesDateRange = false;
                        } else if (dateFrom || dateTo) {
                            matchesDateRange = false;
                        }
                    }

                    // Search order filter (searches in NCX_ORDERID and CUSTOMER_NAME)
                    const matchesSearchOrder = !searchOrder || 
                        (row.NCX_ORDERID && row.NCX_ORDERID.toLowerCase().includes(searchOrder)) ||
                        (row.CUSTOMER_NAME && row.CUSTOMER_NAME.toLowerCase().includes(searchOrder));

                    // Description filter
                    const matchesDescription = !description || 
                        (row.DESCRIPTION && row.DESCRIPTION.toLowerCase().includes(description));

                    // Dropdown filters
                    const matchesWfmStatus = !wfmStatus || row.WFM_STATUS === wfmStatus;
                    const matchesOwnerGroup = !ownerGroup || row.OWNERGROUP === ownerGroup;
                    const matchesProductName = !productName || row.PRODUCTNAME === productName;
                    const matchesOrderType = !orderType || row.ORDER_TYPE === orderType;
                    const matchesSegment = !segment || row.SEGMENT === segment;
                    const matchesKetWo = !ketWo || row.KET_WO === ketWo;

                    return matchesDateRange && matchesSearchOrder && matchesDescription && 
                           matchesWfmStatus && matchesOwnerGroup && matchesProductName && 
                           matchesOrderType && matchesSegment && matchesKetWo;
                });

                updateStats();
                updateCharts();
                renderTable();
            }, 10);
        }

        function clearFilters() {
            document.getElementById('dateFromFilter').value = '';
            document.getElementById('dateToFilter').value = '';
            document.getElementById('searchOrderInput').value = '';
            document.getElementById('descriptionInput').value = '';
            document.getElementById('wfmStatusFilter').value = '';
            document.getElementById('ownerGroupFilter').value = '';
            document.getElementById('productNameFilter').value = '';
            document.getElementById('orderTypeFilter').value = '';
            document.getElementById('segmentFilter').value = '';
            document.getElementById('ketWoFilter').value = '';
            
            filteredData = [...allData];
            updateStats();
            updateCharts();
            renderTable();
        }

        function refreshData() {
            document.getElementById('loadingContainer').style.display = 'flex';
            document.getElementById('tableContainer').style.display = 'none';
            fetchData();
        }

        function exportData() {
            if (filteredData.length === 0) return;
            
            const headers = Object.keys(filteredData[0]);
            const csvContent = [
                headers.map(h => columnMapping[h] || h).join(','),
                ...filteredData.map(row => headers.map(h => `"${row[h] || ''}"`).join(','))
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `order_monitoring_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Debounce function for search input
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Event listeners with debounced search
        document.getElementById('dateFromFilter').addEventListener('change', applyFilters);
        document.getElementById('dateToFilter').addEventListener('change', applyFilters);
        document.getElementById('searchOrderInput').addEventListener('input', debounce(applyFilters, 300));
        document.getElementById('descriptionInput').addEventListener('input', debounce(applyFilters, 300));
        document.getElementById('wfmStatusFilter').addEventListener('change', applyFilters);
        document.getElementById('ownerGroupFilter').addEventListener('change', applyFilters);
        document.getElementById('productNameFilter').addEventListener('change', applyFilters);
        document.getElementById('orderTypeFilter').addEventListener('change', applyFilters);
        document.getElementById('segmentFilter').addEventListener('change', applyFilters);
        document.getElementById('ketWoFilter').addEventListener('change', applyFilters);

        // Initialize
        fetchData();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97691f1250fd2fbd',t:'MTc1NjQzOTgxNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>